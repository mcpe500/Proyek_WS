{"id":"Suzg","dependencies":[{"name":"D:\\Data\\VSCode\\WS\\Proyek\\Proyek_WS\\tsconfig.json","includedInParent":true,"mtime":1718560099775},{"name":"D:\\Data\\VSCode\\WS\\Proyek\\Proyek_WS\\package.json","includedInParent":true,"mtime":1718697026215},{"name":"../utils/AuthUtils","loc":{"line":13,"column":28,"index":905},"parent":"D:\\Data\\VSCode\\WS\\Proyek\\Proyek_WS\\src\\middleware\\AuthMiddleware.ts","resolved":"D:\\Data\\VSCode\\WS\\Proyek\\Proyek_WS\\src\\utils\\AuthUtils.ts"},{"name":"../contracts/enum/ResponseRelated.enum","loc":{"line":14,"column":39,"index":967},"parent":"D:\\Data\\VSCode\\WS\\Proyek\\Proyek_WS\\src\\middleware\\AuthMiddleware.ts","resolved":"D:\\Data\\VSCode\\WS\\Proyek\\Proyek_WS\\src\\contracts\\enum\\ResponseRelated.enum.ts"},{"name":"../models/dynamic/User.model","loc":{"line":15,"column":29,"index":1039},"parent":"D:\\Data\\VSCode\\WS\\Proyek\\Proyek_WS\\src\\middleware\\AuthMiddleware.ts","resolved":"D:\\Data\\VSCode\\WS\\Proyek\\Proyek_WS\\src\\models\\dynamic\\User.model.ts"}],"generated":{"js":"\"use strict\";var t=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))(function(o,r){function i(t){try{u(s.next(t))}catch(e){r(e)}}function a(t){try{u(s.throw(t))}catch(e){r(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,a)}u((s=s.apply(t,e||[])).next())})};Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.validateNotSignIn=exports.validateIsNotAdmin=exports.validateAdmin=exports.validateAccessToken=void 0;const e=require(\"../utils/AuthUtils\"),n=require(\"../contracts/enum/ResponseRelated.enum\"),s=require(\"../models/dynamic/User.model\"),o=(o,r,i)=>t(void 0,void 0,void 0,function*(){const t=o.headers.authorization;if(!t)return r.status(n.RESPONSE_STATUS.UNAUTHORIZED).send(\"Unauthorized\");const[a,u]=t.split(\" \");if(\"Bearer\"!=a)return r.status(n.RESPONSE_STATUS.UNAUTHORIZED).send(\"Unauthorized\");try{const t=(0,e.verifyAccessToken)(u);if(!t)return r.status(n.RESPONSE_STATUS.UNAUTHORIZED).send(\"Unauthorized\");const{username:a,email:c}=t;try{const t=yield s.User.findOne({$or:[{username:a},{email:c}]});if(!t)return r.status(n.RESPONSE_STATUS.NOT_FOUND).json({msg:\"User not found\"});o.user=t,i()}catch(d){return r.status(n.RESPONSE_STATUS.INTERNAL_SERVER_ERROR).json({msg:\"Internal server error\"})}}catch(d){return r.status(n.RESPONSE_STATUS.UNAUTHORIZED).send(\"Unauthorized\")}});exports.validateAccessToken=o;const r=(e,s,o)=>t(void 0,void 0,void 0,function*(){const{user:t}=e.body;if(t&&\"ADMIN\"!=t.role)return s.status(n.RESPONSE_STATUS.UNAUTHORIZED).json({msg:\"User is not admin\"});o()});exports.validateAdmin=r;const i=(e,s,o)=>t(void 0,void 0,void 0,function*(){const t=e.user;if(t&&\"ADMIN\"==t.role)return s.status(n.RESPONSE_STATUS.UNAUTHORIZED).json({msg:\"Only Customers Are Allowed!\"});o()});exports.validateIsNotAdmin=i;const a=(e,s,o)=>t(void 0,void 0,void 0,function*(){if(e.headers.authorization)return s.status(n.RESPONSE_STATUS.UNAUTHORIZED).send(\"Please Logout First!\");o()});exports.validateNotSignIn=a;"},"sourceMaps":{"js":{"mappings":[{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":0}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":13}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":17}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":19}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":25}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":30}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":41}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":50}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":52}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":54}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":56}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":59}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":66}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":70}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":74}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":76}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":86}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":95}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":97}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":100}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":109}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":111}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":114}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":118}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":120}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":122}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":127}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":131}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":137}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":140}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":142}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":146}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":155}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":157}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":160}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":164}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":166}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":168}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":174}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":178}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":184}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":187}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":189}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":193}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":202}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":204}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":207}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":211}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":213}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":215}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":220}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":222}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":224}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":232}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":234}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":236}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":242}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":255}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":257}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":259}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":263}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":265}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":274}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":277}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":279}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":285}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":290}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":292}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":295}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":298}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":300}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":302}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":308}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":310}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":313}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":318}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":329}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":336}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":351}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":359}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":372}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":373}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":380}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":384}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":392}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":410}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":418}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":437}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":445}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":459}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":467}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":492}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":494}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":500}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":502}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":510}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":532}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":534}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":3,"column":0},"generated":{"line":1,"column":542}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":584}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":586}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":4,"column":0},"generated":{"line":1,"column":594}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":6,"column":13},"generated":{"line":1,"column":626}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":6,"column":35},"generated":{"line":1,"column":628}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":7,"column":2},"generated":{"line":1,"column":629}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":8,"column":2},"generated":{"line":1,"column":631}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":9,"column":2},"generated":{"line":1,"column":633}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":10,"column":4},"generated":{"line":1,"column":637}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":10,"column":4},"generated":{"line":1,"column":644}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":10,"column":4},"generated":{"line":1,"column":651}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":10,"column":4},"generated":{"line":1,"column":658}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":10,"column":4},"generated":{"line":1,"column":660}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":11,"column":2},"generated":{"line":1,"column":672}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":11,"column":8},"generated":{"line":1,"column":678}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":11,"column":16},"generated":{"line":1,"column":680}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":11,"column":20},"generated":{"line":1,"column":682}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":11,"column":28},"generated":{"line":1,"column":690}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":12,"column":2},"generated":{"line":1,"column":704}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":12,"column":7},"generated":{"line":1,"column":708}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":13,"column":4},"generated":{"line":1,"column":710}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":13,"column":11},"generated":{"line":1,"column":717}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":13,"column":15},"generated":{"line":1,"column":719}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":13,"column":22},"generated":{"line":1,"column":726}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":13,"column":22},"generated":{"line":1,"column":728}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":13,"column":38},"generated":{"line":1,"column":744}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":13,"column":52},"generated":{"line":1,"column":758}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":13,"column":57},"generated":{"line":1,"column":763}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":15,"column":2},"generated":{"line":1,"column":779}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":15,"column":9},"generated":{"line":1,"column":785}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":15,"column":17},"generated":{"line":1,"column":787}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":15,"column":32},"generated":{"line":1,"column":790}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":15,"column":38},"generated":{"line":1,"column":792}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":15,"column":44},"generated":{"line":1,"column":798}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":16,"column":2},"generated":{"line":1,"column":803}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":16,"column":16},"generated":{"line":1,"column":806}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":16,"column":6},"generated":{"line":1,"column":816}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":17,"column":4},"generated":{"line":1,"column":818}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":17,"column":11},"generated":{"line":1,"column":825}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":17,"column":15},"generated":{"line":1,"column":827}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":17,"column":22},"generated":{"line":1,"column":834}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":17,"column":22},"generated":{"line":1,"column":836}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":17,"column":38},"generated":{"line":1,"column":852}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":17,"column":52},"generated":{"line":1,"column":866}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":17,"column":57},"generated":{"line":1,"column":871}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":19,"column":2},"generated":{"line":1,"column":887}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":20,"column":4},"generated":{"line":1,"column":891}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":20,"column":10},"generated":{"line":1,"column":897}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":20,"column":25},"generated":{"line":1,"column":900}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":20,"column":25},"generated":{"line":1,"column":902}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":20,"column":25},"generated":{"line":1,"column":904}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":20,"column":43},"generated":{"line":1,"column":923}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":21,"column":4},"generated":{"line":1,"column":926}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":21,"column":9},"generated":{"line":1,"column":930}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":22,"column":6},"generated":{"line":1,"column":932}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":22,"column":13},"generated":{"line":1,"column":939}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":22,"column":17},"generated":{"line":1,"column":941}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":22,"column":24},"generated":{"line":1,"column":948}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":22,"column":24},"generated":{"line":1,"column":950}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":22,"column":40},"generated":{"line":1,"column":966}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":22,"column":54},"generated":{"line":1,"column":980}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":22,"column":59},"generated":{"line":1,"column":985}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":24,"column":4},"generated":{"line":1,"column":1001}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":24,"column":10},"generated":{"line":1,"column":1007}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":24,"column":12},"generated":{"line":1,"column":1016}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":24,"column":20},"generated":{"line":1,"column":1018}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":24,"column":22},"generated":{"line":1,"column":1024}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":24,"column":32},"generated":{"line":1,"column":1027}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":25,"column":4},"generated":{"line":1,"column":1029}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":6},"generated":{"line":1,"column":1033}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":12},"generated":{"line":1,"column":1039}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":25},"generated":{"line":1,"column":1047}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":25},"generated":{"line":1,"column":1049}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":30},"generated":{"line":1,"column":1054}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":38},"generated":{"line":1,"column":1062}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":40},"generated":{"line":1,"column":1063}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":45},"generated":{"line":1,"column":1067}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":46},"generated":{"line":1,"column":1068}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":48},"generated":{"line":1,"column":1069}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":48},"generated":{"line":1,"column":1078}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":60},"generated":{"line":1,"column":1081}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":62},"generated":{"line":1,"column":1082}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":26,"column":62},"generated":{"line":1,"column":1088}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":27,"column":6},"generated":{"line":1,"column":1094}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":27,"column":10},"generated":{"line":1,"column":1098}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":31,"column":8},"generated":{"line":1,"column":1100}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":31,"column":15},"generated":{"line":1,"column":1107}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":32,"column":11},"generated":{"line":1,"column":1109}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":32,"column":18},"generated":{"line":1,"column":1116}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":32,"column":18},"generated":{"line":1,"column":1118}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":32,"column":34},"generated":{"line":1,"column":1134}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":33,"column":11},"generated":{"line":1,"column":1145}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":33,"column":16},"generated":{"line":1,"column":1150}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":33,"column":18},"generated":{"line":1,"column":1151}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":33,"column":23},"generated":{"line":1,"column":1155}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":28,"column":9},"generated":{"line":1,"column":1174}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":28,"column":21},"generated":{"line":1,"column":1176}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":28,"column":28},"generated":{"line":1,"column":1181}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":29,"column":8},"generated":{"line":1,"column":1183}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":35,"column":6},"generated":{"line":1,"column":1187}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":35,"column":13},"generated":{"line":1,"column":1193}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":36,"column":6},"generated":{"line":1,"column":1196}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":36,"column":13},"generated":{"line":1,"column":1203}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":37,"column":9},"generated":{"line":1,"column":1205}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":37,"column":16},"generated":{"line":1,"column":1212}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":37,"column":16},"generated":{"line":1,"column":1214}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":37,"column":32},"generated":{"line":1,"column":1230}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":38,"column":9},"generated":{"line":1,"column":1253}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":38,"column":14},"generated":{"line":1,"column":1258}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":38,"column":16},"generated":{"line":1,"column":1259}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":38,"column":21},"generated":{"line":1,"column":1263}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":40,"column":4},"generated":{"line":1,"column":1290}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":40,"column":11},"generated":{"line":1,"column":1296}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":41,"column":4},"generated":{"line":1,"column":1299}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":41,"column":11},"generated":{"line":1,"column":1306}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":41,"column":15},"generated":{"line":1,"column":1308}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":41,"column":22},"generated":{"line":1,"column":1315}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":41,"column":22},"generated":{"line":1,"column":1317}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":41,"column":38},"generated":{"line":1,"column":1333}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":41,"column":52},"generated":{"line":1,"column":1347}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":41,"column":57},"generated":{"line":1,"column":1352}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":6,"column":13},"generated":{"line":1,"column":1371}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":6,"column":13},"generated":{"line":1,"column":1379}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":6,"column":32},"generated":{"line":1,"column":1399}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":45,"column":7},"generated":{"line":1,"column":1401}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":45,"column":13},"generated":{"line":1,"column":1407}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":45,"column":29},"generated":{"line":1,"column":1409}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":46,"column":2},"generated":{"line":1,"column":1410}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":47,"column":2},"generated":{"line":1,"column":1412}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":48,"column":2},"generated":{"line":1,"column":1414}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":1,"column":1418}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":1,"column":1425}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":1,"column":1432}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":1,"column":1439}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":49,"column":4},"generated":{"line":1,"column":1441}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":50,"column":2},"generated":{"line":1,"column":1453}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":50,"column":8},"generated":{"line":1,"column":1459}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":50,"column":10},"generated":{"line":1,"column":1464}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":50,"column":19},"generated":{"line":1,"column":1467}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":50,"column":23},"generated":{"line":1,"column":1469}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":51,"column":2},"generated":{"line":1,"column":1474}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":51,"column":6},"generated":{"line":1,"column":1477}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":51,"column":27},"generated":{"line":1,"column":1480}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":51,"column":14},"generated":{"line":1,"column":1489}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":51,"column":19},"generated":{"line":1,"column":1491}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":52,"column":4},"generated":{"line":1,"column":1496}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":52,"column":11},"generated":{"line":1,"column":1503}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":53,"column":7},"generated":{"line":1,"column":1505}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":53,"column":14},"generated":{"line":1,"column":1512}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":53,"column":14},"generated":{"line":1,"column":1514}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":53,"column":30},"generated":{"line":1,"column":1530}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":54,"column":7},"generated":{"line":1,"column":1544}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":54,"column":12},"generated":{"line":1,"column":1549}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":54,"column":14},"generated":{"line":1,"column":1550}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":54,"column":19},"generated":{"line":1,"column":1554}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":55,"column":2},"generated":{"line":1,"column":1576}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":45,"column":13},"generated":{"line":1,"column":1582}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":45,"column":13},"generated":{"line":1,"column":1590}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":45,"column":26},"generated":{"line":1,"column":1604}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":58,"column":7},"generated":{"line":1,"column":1606}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":58,"column":13},"generated":{"line":1,"column":1612}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":58,"column":34},"generated":{"line":1,"column":1614}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":59,"column":2},"generated":{"line":1,"column":1615}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":60,"column":2},"generated":{"line":1,"column":1617}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":61,"column":2},"generated":{"line":1,"column":1619}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":62,"column":4},"generated":{"line":1,"column":1623}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":62,"column":4},"generated":{"line":1,"column":1630}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":62,"column":4},"generated":{"line":1,"column":1637}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":62,"column":4},"generated":{"line":1,"column":1644}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":62,"column":4},"generated":{"line":1,"column":1646}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":63,"column":2},"generated":{"line":1,"column":1658}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":63,"column":8},"generated":{"line":1,"column":1664}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":63,"column":16},"generated":{"line":1,"column":1666}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":63,"column":28},"generated":{"line":1,"column":1668}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":64,"column":2},"generated":{"line":1,"column":1673}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":64,"column":6},"generated":{"line":1,"column":1676}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":64,"column":27},"generated":{"line":1,"column":1679}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":64,"column":14},"generated":{"line":1,"column":1688}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":64,"column":19},"generated":{"line":1,"column":1690}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":65,"column":4},"generated":{"line":1,"column":1695}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":65,"column":11},"generated":{"line":1,"column":1702}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":66,"column":7},"generated":{"line":1,"column":1704}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":66,"column":14},"generated":{"line":1,"column":1711}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":66,"column":14},"generated":{"line":1,"column":1713}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":66,"column":30},"generated":{"line":1,"column":1729}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":67,"column":7},"generated":{"line":1,"column":1743}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":67,"column":12},"generated":{"line":1,"column":1748}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":67,"column":14},"generated":{"line":1,"column":1749}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":67,"column":19},"generated":{"line":1,"column":1753}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":68,"column":2},"generated":{"line":1,"column":1785}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":58,"column":13},"generated":{"line":1,"column":1791}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":58,"column":13},"generated":{"line":1,"column":1799}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":58,"column":31},"generated":{"line":1,"column":1818}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":7},"generated":{"line":1,"column":1820}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":13},"generated":{"line":1,"column":1826}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":33},"generated":{"line":1,"column":1828}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":72,"column":2},"generated":{"line":1,"column":1829}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":73,"column":2},"generated":{"line":1,"column":1831}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":74,"column":2},"generated":{"line":1,"column":1833}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":75,"column":4},"generated":{"line":1,"column":1837}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":75,"column":4},"generated":{"line":1,"column":1844}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":75,"column":4},"generated":{"line":1,"column":1851}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":75,"column":4},"generated":{"line":1,"column":1858}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":75,"column":4},"generated":{"line":1,"column":1860}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":77,"column":2},"generated":{"line":1,"column":1872}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":76,"column":16},"generated":{"line":1,"column":1875}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":76,"column":20},"generated":{"line":1,"column":1877}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":76,"column":28},"generated":{"line":1,"column":1885}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":78,"column":4},"generated":{"line":1,"column":1899}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":78,"column":11},"generated":{"line":1,"column":1906}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":78,"column":15},"generated":{"line":1,"column":1908}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":78,"column":22},"generated":{"line":1,"column":1915}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":78,"column":22},"generated":{"line":1,"column":1917}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":78,"column":38},"generated":{"line":1,"column":1933}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":78,"column":52},"generated":{"line":1,"column":1947}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":78,"column":57},"generated":{"line":1,"column":1952}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":80,"column":2},"generated":{"line":1,"column":1976}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":13},"generated":{"line":1,"column":1982}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":13},"generated":{"line":1,"column":1990}},{"source":"middleware/AuthMiddleware.ts","name":null,"original":{"line":71,"column":30},"generated":{"line":1,"column":2008}}],"sources":{"middleware/AuthMiddleware.ts":"import { NextFunction, Request, Response } from \"express\";\r\nimport { verifyAccessToken } from \"../utils/AuthUtils\";\r\nimport { RESPONSE_STATUS } from \"../contracts/enum/ResponseRelated.enum\";\r\nimport { User } from \"../models/dynamic/User.model\";\r\n\r\nexport const validateAccessToken = async (\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction\r\n) => {\r\n  const token = req.headers.authorization;\r\n  if (!token) {\r\n    return res.status(RESPONSE_STATUS.UNAUTHORIZED).send(\"Unauthorized\");\r\n  }\r\n  const [prefix, accessToken] = token.split(\" \");\r\n  if (prefix != \"Bearer\") {\r\n    return res.status(RESPONSE_STATUS.UNAUTHORIZED).send(\"Unauthorized\");\r\n  }\r\n  try {\r\n    const decodedToken = verifyAccessToken(accessToken);\r\n    if (!decodedToken) {\r\n      return res.status(RESPONSE_STATUS.UNAUTHORIZED).send(\"Unauthorized\");\r\n    }\r\n    const { username, email } = decodedToken;\r\n    try {\r\n      const user = await User.findOne({ $or: [{ username }, { email }] });\r\n      if (user) {\r\n        (req as any).user = user;\r\n        next();\r\n      } else {\r\n        return res\r\n          .status(RESPONSE_STATUS.NOT_FOUND)\r\n          .json({ msg: \"User not found\" });\r\n      }\r\n    } catch (error) {\r\n      return res\r\n        .status(RESPONSE_STATUS.INTERNAL_SERVER_ERROR)\r\n        .json({ msg: \"Internal server error\" });\r\n    }\r\n  } catch (error) {\r\n    return res.status(RESPONSE_STATUS.UNAUTHORIZED).send(\"Unauthorized\");\r\n  }\r\n};\r\n\r\nexport const validateAdmin = async (\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction\r\n) => {\r\n  const { user } = req.body;\r\n  if (user && user.role != \"ADMIN\")\r\n    return res\r\n      .status(RESPONSE_STATUS.UNAUTHORIZED)\r\n      .json({ msg: \"User is not admin\" });\r\n  next();\r\n};\r\n\r\nexport const validateIsNotAdmin = async (\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction\r\n) => {\r\n  const user = (req as any).user;\r\n  if (user && user.role == \"ADMIN\")\r\n    return res\r\n      .status(RESPONSE_STATUS.UNAUTHORIZED)\r\n      .json({ msg: \"Only Customers Are Allowed!\" });\r\n  next();\r\n};\r\n\r\nexport const validateNotSignIn = async (\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction\r\n) => {\r\n  const token = req.headers.authorization;\r\n  if (token) {\r\n    return res.status(RESPONSE_STATUS.UNAUTHORIZED).send(\"Please Logout First!\");\r\n  }\r\n  next();\r\n};\r\n"},"lineCount":null}},"error":null,"hash":"e6c7984e75181981edb5b5604c2c4348","cacheData":{"env":{}}}